@page "/game-of-life"

<h1>Game Of Live</h1>
<p>Current count: @currentCount and current radio @theRadio</p>
<hr />

<hr>
<p>
    <input type="radio" name="myradiobtn" checked="@(theRadio.Equals("step"))" value="step" @onchange="ClickRadio" />
    Step by step
    <input type="radio" name="myradiobtn" checked="@(theRadio.Equals("many"))" value="many" @onchange="ClickRadio" />
    Several steps
</p>

<div style="display:@(theRadio.Equals("many")?"":"none")">
    <h5>Cycles specification </h5>
    Number of cycles:
    <input @bind="cyclesPerTime" /> (internal value: @cyclesPerTime)
    <hr>
    <br>
    <select @bind="option">
        <option value="90">1 st </option>
        <option value="78.5">2 nd </option>
    </select>
    <br>
    Our option is @option
</div>


<button class="btn btn-primary" @onclick="AddPattern">@AddPatternText</button>
<div style="display:@(isPatternShowed ? "block" : "none")">
    <p>Add the pattern pentadecathlon</p>
    <h5></h5>
    row
    <input @bind="row" />
    col
    <input @bind="col" /> Pattern pentadecathlon
    <button class="btn btn-primary" @onclick="Add" >@AddButton</button>

</div>

<button class="btn btn-primary" @onclick="IncrementCount">Next</button>
<a class="btn btn-primary" target="_blank" href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_life">Look for
    Patterns in Wikipedia
</a>



@{
    if (currentCount == 0)
    {
        e.put_pattern(6, 6, "pentadecathlon");
        e.put_pattern(15, 15, "pentadecathlon");
    }
}

<hr />
<table class="environment">
    @for (int i = 0; i < @e.total_of_rows(); i++)
    {
        <tr>
            @for (int j = 0; j < @e.total_of_cols(); j++)
            {
                @if (e.is_alive(i, j))
                {
                    <td class="cell alive"></td>
                }
                else
                {
                    <td class="cell dead"></td>
                }
            }
        </tr>
    }
</table>
<hr />



@code {
    private int cyclesPerTime = 0;
    private int currentCount = 0;
    private int row = 0;
    private int col = 0;

    private Data.GameOfLife.Environment e = new Data.GameOfLife.Environment(30, 30);
    private string theRadio = "";
    private bool isPatternShowed = false;
    private string AddPatternText = "Add Pattern...";
    private string AddButton = "Add";

    private string option = "";
    private void IncrementCount()
    {
        currentCount++;
        e.nextConwayStep();
    }
    private void AddPattern()
    {
        if (isPatternShowed)
        {
            isPatternShowed = false;
        }
        else
        {
            isPatternShowed = true;
        }

        if (isPatternShowed)
        {
            AddPatternText = "Add Pattern(-)";
        }
        else
        {
            AddPatternText = "Add Pattern...";
        }
    }

    private void Add() {
        e.put_pattern(row, col, "pentadecathlon");
        row = col = 0;
    }

    private void ClickRadio(ChangeEventArgs args)
    {
        theRadio = args.Value.ToString();
        currentCount++;
    }
}